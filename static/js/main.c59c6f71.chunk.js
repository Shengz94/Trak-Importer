(this["webpackJsonptrack-importer"]=this["webpackJsonptrack-importer"]||[]).push([[0],{38:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(12),o=n.n(a),i=(n(38),n(8)),s=n(17),u=n(3),l=n(22),d=n.n(l),j=n(26),p=n(63);var b=function(e){return"undefined"===e||"null"===e||""===e||"undefined"===typeof e||void 0===e||null===e},f=n(64),h=n(2),O=Object(u.g)((function(e){var t=Object(c.useState)(),n=Object(i.a)(t,2),r=(n[0],n[1],Object(c.useState)()),a=Object(i.a)(r,2),o=a[0],s=a[1];return Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"file",onChange:function(e){return function(e){e.preventDefault(),s(e.target.files[0])}(e)}}),Object(h.jsx)(p.a,{disabled:b(o),onClick:function(){var t=new FileReader;t.onload=function(){var t=Object(j.a)(d.a.mark((function t(n){var c,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=n.target.result.split("\n"),r=new Map,c.forEach((function(e){var t={id:Object(f.a)(),sourceTitle:e,traktTitle:[],selected:{},import:!0};r.set(t.id,t)})),e.populateTitles(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.readAsText(o),e.history.push("/Import-Trakt")},children:"Process titles"})]})})),k=n(32),x=(n(31),"3f2a4833bca232c1afbb66c2a56447e7d75b44372af9d45f11cf0b907b326b92"),m="https://api.trakt.tv/",g="https://shengz94.github.io/trak-history-importer/";var v=function(e){return Object(h.jsxs)("div",{className:"title-list",children:[Object(k.a)(e.titles.values()).map((function(t){e.updateTitle,e.handleImportCheckBox,e.handleSelectedChange})),Object(h.jsx)(p.a,{onClick:function(){},children:"Import titles"})]})},_=Object(u.g)((function(e){var t=m+"oauth/authorize/?client_id="+x+"&redirect_uri="+encodeURI(g)+"&response_type=code";return Object(h.jsx)("div",{children:Object(h.jsx)(p.a,{size:"small",variant:"contained",onClick:function(){window.location.href=t},children:"Log in"})})})),T=function(e){return Object(h.jsx)("div",{})},y=function(e){var t=Object(c.useState)(new Map),n=Object(i.a)(t,2),r=(n[0],n[1]),a=Object(c.useState)([]),o=Object(i.a)(a,2),l=(o[0],o[1],Object(c.useState)()),d=Object(i.a)(l,2),j=(d[0],d[1]),p=Object(c.useState)(localStorage.getItem("userToken")),f=Object(i.a)(p,2),k=f[0],m=f[1];return Object(c.useEffect)((function(){localStorage.setItem("userToken",k)}),[k]),Object(c.useEffect)((function(){if(console.log(k),b(k)){var e=new URLSearchParams(window.location.search).get("code");console.log(e),b(e)||(console.log("asd"),function(e){return fetch("https://api.trakt.tv/oauth/token/",{headers:{"Content-Type":"application/json","trakt-api-key":x,"trakt-api-version":"2"},body:{code:e,client_id:x,client_secret:"ea9ac4d176818616f44dc3a3d643cf73569590ae0c055d2dc190023d9762ea81",redirect_uri:g,grant_type:"authorization_code"},method:"post"}).then((function(e){return console.log(e),e.json()})).then((function(e){return{access_token:e.access_token,expireIn:e.expires_in,refreshToken:e.refresh_token,created_at:e.created_at}}))}(e).then((function(e){var t;console.log("token"+e.access_token),m(e.access_token),(t=e.access_token,fetch("https://api.trakt.tv/users/settings/",{headers:{"Content-Type":"application/json","trakt-api-key":x,"trakt-api-version":"2",Authorization:"Bearer "+t},method:"get"}).then((function(e){return e.json()})).then((function(e){return{username:e.username,name:e.name,uuid:e.ids.uuid,slug:e.ids.slug,image:e.images.avatar.full}}))).then((function(e){j(e)}))})))}}),[]),Object(h.jsx)(s.a,{basename:"/Trakt-Importer",children:Object(h.jsxs)(u.d,{children:[Object(h.jsx)(u.b,{exact:!0,path:"/",children:b(k)?Object(h.jsx)(_,{}):Object(h.jsx)(u.a,{to:"Home"})}),Object(h.jsx)(u.b,{exact:!0,path:"/Home",children:Object(h.jsx)(O,{populateTitles:function(e){return function(e){r(e),console.log(e)}(e)}})}),Object(h.jsx)(u.b,{exact:!0,path:"/Home",render:function(){return Object(h.jsx)(O,{})}}),Object(h.jsx)(u.b,{exact:!0,path:"/Import-Trakt",render:function(){return Object(h.jsx)(v,{})}}),Object(h.jsx)(u.b,{exact:!0,path:"/Result",render:function(){return Object(h.jsx)(T,{})}})]})})};o.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(y,{})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.c59c6f71.chunk.js.map